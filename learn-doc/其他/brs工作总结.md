# brs 工作总结

---

## 1 权限设计
1. 目的：安全性。
2. 方法：如何实现，如何设计。
3. 知识点：菜单权限，功能（接口权限），操作权限。

## 1.1 实际需求

---
1. 表字段控制访问，字段权限。
2. 表字段的写入权限控制。

## 1.2 设计方案

1. 有现成的安全框架：shiro,security。
为什么不用呢？它不容易定制字段基本的访问控制。
2. 采用拦截器，过滤器实现，鉴权，接口权限控制。
3. 采用aop切面实现字段控制。
4. 后期改进，直接在表查询后返回有权限访问的数据。

OA系统采用前后端分离设计，后端服务只提供api接口。针对接口的权限设计，具体可分为功能权限，数据权限。
功能权限：判断当前用户（subject,不一定是用户也可以是其他主体入设备）是否具有访问该接口的权限。
数据权限：判断当前用户（subject）对具体数据的读写权限，如根据其所属部门限制读取数据的范围；以及对访问修改字段值的限制。

## 1.3 存在的问题和改进点
1. 现在页面菜单，按钮的权限是固定的，不利于后期的项目的变更扩展，需要设计成动态的。
2. 现在权限控制功能比较单一，必须考虑复制情况，部门-角色；人员-权限；等。
问题：部门成员申请审批；多级审批人如何确定？

## 2 前后端分离设计

---
## 2.1 前后端分离的好处，优点？

1. 全栈工程师很难招聘，很难培养，很多后端开发人员不愿意学前端技术，而很多前端开发人员怕学后端技术；

2. 如果前后端不分离，前端工程师的工作就必须依赖后端工程师，前端工程师变成打杂的，职业生涯前景惨淡；

3. 前后端分离后，前端和后端工程师独立开发，大大提高开发效率；

4. 综合来讲，前后端分离的用人成本远低于全栈工程师用人成本；同时，前后端分离的工作效率远大于耦合工作的工作效率；

## 2.2 api 文档服务器
软件开发流程中的几个关键环节：

1. 产品经理提需求，画原型；

2. UI设计师根据原型出设计图；

3. 测试团队根据产品原型编写测试用例，制定测试计划；

4. 架构师根据原型编写API文档；

5. 前后端工程师基于API文档完成业务开发；

6. 测试、改BUG、发布。

## 2.3 自己设计api文档服务器
参考：[svn，sj实现api文档服务器](https://www.cnblogs.com/leotsai/p/vuejs-front-backend-architecture.html)

## 2.4 采用swagger生成api文档
优点：

缺点：缺少版本管理。

## 3. 前端vue

### 3.1 vue
注意点：SPA 单页应用。其局限性？

## 4. REST 架构

---
参考[REST架构设计](https://blog.csdn.net/justloveyou_/article/details/74379479)
### 4.1 mvc 
缺点：

1. 每次请求必须经过“控制器->模型->视图”这个流程，用户才能看到最终的展现的界面，这个过程似乎有些复杂；

2. 实际上视图是依赖于模型的，换句话说，如果没有模型，视图也无法呈现出最终的效果；

3. 渲染视图的过程是在服务端来完成的，最终呈现给浏览器的是带有模型的视图页面，性能无法得到很好的优化。

### 4.2 REST
Representational State Transfer 表述性状态转移

URL(Uniform Resoure Locator:统一资源定位器)

HTTP 请求方式：(CURD)create-Retrieve-update-delete

1. GET (query)
2. POST(insert)
3. PUT(update)
4. DELETE(delete)
5. HEAD
6. OPTIONS

REST是面向资源(ROA)的，这里提到的资源，实际上就是我们常说的领域对象，在系统设计过程中，我们经常通过领域对象来进行数据建模。

### 4.2 实现REST框架
#### 4.2.1 统一响应结构

元数据与返回值

#### 4.2.2 前后台数据转换
问题：日期格式数据传递问题？
@RequestBody

#### 4.2.3 异常处理
aop @ControllerAdvice

#### 4.2.4 参数验证
Bean Validation

#### 4.2.5 解决跨域问题
CORS（Cross Origin Resourcee Sharing 跨域资源共享）
filter

#### 4.3.6 安全机制

#### 4.3.7 cookie session token

参考 [session token 设计]（https://www.cnblogs.com/moyand/p/9047978.html）

#### 4.3.8 JWT Redis

#### 4.3.9 单点登录实现

### 5 LDAP
LDAP (Light Directory Access Protocol)轻量级目录访问协议

目录是一个为查询、浏览和搜索而优化的数据库，它成树状结构组织数据，类似文件目录一样。

目录数据库和关系数据库不同，它有优异的读性能，但写性能差，并且没有事务处理、回滚等复杂功能，不适于存储修改频繁的数据。所以目录天生是用来查询的，就好象它的名字一样。

LDAP目录服务是由目录数据库和一套访问协议组成的系统。

#### 5.1 LDAP的主要产品

SUNONE Directory Server
基于文本数据库的存储，速度快 。

IBM Directory Server
基于DB2 的的数据库，速度一般。

Novell Directory Server
基于文本数据库的存储，速度快, 不常用到。

Microsoft Active Directory
基于WINDOWS系统用户，对大数据量处理速度一般，但维护容易，生态圈大，管理相对简单。

Opensource
OpenLDAP 开源的项目，速度很快，但是非主 流应用。

开源项目YAPL

#### 5.2 LDAP 实现统一身份认证
参考:

[ldap说明](https://www.cnblogs.com/wilburxu/p/9174353.html)

[oepn ldap](https://segmentfault.com/a/1190000014683418)

应用：通过访问AD实现身份认证

问题：如何实现AD中用户密码的修改？ 需要添加证书。

### 6 mybatis orm 面向对象关系模型
#### 6.1 mybatis 原理
#### 6.2 mybatis 注解，xml文件

### 7 jpa

### 8 po do dto vo
#### 8.1 如何实现对象转换， 对象深拷贝，浅拷贝



