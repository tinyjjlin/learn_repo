# 单点登录设计


## 单点登录（SSO）
SSO(Single Sign On)单点登录是实现多个系统之间统一登录的验证系统。
用户一次登录，可以访问多个系统。

## 常见的实现方案
1. cookie 作为凭证媒介
2. JSONP实现
3. 通过页面重定向的方式
4. 使用独立登录系统

## 遇到的问题
如何解决跨域的问题


## 具体实现
###1  采用的方案：

1. 采用独立的登录系统;
2. 同父域，解决跨域的问题;
3. JWT 认证协议。

###2  单点登录架构
![架构](./sso_schema.png)

###3  具体操作
1 多个系统登录

![login](./sso_login.png)

2当有系统退出时

![logout](./sso_logout.png)

说明：

初始系统A,B都处于未登录状态，浏览器cookie中没有令牌token。

1. 用户访问系统A,没有令牌，A系统验证未登录，浏览器重定向到登录界面并附带上系统A的路径。
2. SSO服务验证用户登录信息是否正确，验证通过，生成token,将token保存到redis中，和本地cookie中。
3. 登录页面，登录成功后，重定向到系统A请求的页面路径。
4. 系统A发起请求，请求到达SSO验证token是否有效，以及对请求权限进行验证。
5. 请求验证通过，跳转到系统A首页或用户请求的页面。
